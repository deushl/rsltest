$().ready(function(){Viewer.bDefaultMessagesOnActionDone=!0,MC.Fset_mod_p("my_work",{init:!0}),MC.Fset_mod_p("formulations",{init:!0}),MC.Fset_mod_p("compositions",{init:!0}),MC.Fset_mod_p("comp_r",{init:!0}),MC.Fset_mod_p("comp_u",{init:!0}),MC.Fset_mod_p("comp_c",{init:!0}),MC.Fset_mod_p("monomers",{init:!0}),MC.Fset_mod_p("mon_r",{init:!0}),MC.Fset_mod_p("mon_u",{init:!0}),MC.Fset_mod_p("mon_c",{init:!0}),MC.Fset_mod_p("monprov_c",{init:!0}),MC.Fset_mod_p("monprov_r",{init:!0}),MC.Fset_mod_p("monprov_u",{init:!0}),MC.Fset_mod_p("fout_u",{init:!0}),MC.Fset_mod_p("catalogs",{init:!0}),MC.Fset_mod_p("forml_r",{init:!0}),MC.Fset_mod_p("forml_u",{init:!0}),MC.Fset_mod_p("forml_c",{init:!0}),MC.Fset_mod_p("forml_cc",{init:!0}),MC.Fset_mod_p("fout_u",{init:!0}),MC.Fset_mod_p("fout_c",{init:!0}),MC.Fset_mod_p("fout_r",{init:!0}),MC.Fset_mod_p("fout_att_r",{init:!0}),MC.Fset_mod_p("fout_att_u",{init:!0}),MC.Fset_mod_p("xp_r",{init:!0}),MC.Fset_mod_p("xp_u",{init:!0}),MC.Fset_mod_p("xp_c",{init:!0}),MC.Fset_mod_p("cat_r",{init:!0}),MC.Fset_mod_p("cat_entry_u",{init:!0}),MC.Fset_mod_p("outpreset_c",{init:!0}),MC.Fset_mod_p("forml_wz_2",{init:!0}),MC.Fset_mod_p("forml_assoc",{init:!0}),MC.Fset_mod_p("ai",{init:!0}),MC.Fset_mod_p("processes",{init:!0}),MC.Fset_mod_p("proc_c",{init:!0}),MC.Fset_mod_p("proc_u",{init:!0}),MC.Fset_mod_p("proc_r",{init:!0}),MC.Fset_mod_p("planner_c",{init:!0}),MC.Fset_mod_p("planner_u",{init:!0}),MC.Fset_mod_p("planner_r",{init:!0}),MC.Fset_mod_p("planchart_c",{init:!0}),MC.Fset_actions({my_work:{r:"my_work",v:"r"},sys:{r:"sys",v:"r"},users:{r:"users",v:"r"},catalogs:{r:"catalogs",v:"r"},formulations:{r:"formulations",v:"r"},compositions:{r:"compositions",v:"r"},monomers:{r:"monomers",v:"r"},test_impact:{r:"test_impact",v:"r"},ai:{r:"ai",v:"r"},processes:{r:"processes",v:"r"},swclick:{r:"FSWClick",v:"r"}}),MC.Fset_mod_actions("my_work",{add_x:{r:"xp_c",v:"r"},edit_x:{r:"xp_u",v:"r"},get_x:{r:"xps_r",v:"r"},get_f:{r:"formls_r",v:"r"},det_x:{r:"xp_r",v:"r"},add:{r:"forml_c",v:"r"},copy:{r:"forml_wz_2",v:"r"},edit:{r:"forml_u",v:"r"},get:{r:"formls_r",v:"r"},det:{r:"forml_r",v:"r"},owner:{r:"Fowner_only",v:"r"},get_usrcoll:{r:"collgrp_r",v:"r"},get_mon:{r:"filtermon_r",v:"r"},get_add:{r:"filteradd",v:"r"},search:{r:"forml_s",v:"r"}}),MC.Fset_mod_actions("forml_wz_1",{scratch:{r:"forml_c",v:"r"},copy:{r:"forml_wz_2",v:"r"},option:{r:"Fwz1_option",v:"r"}}),MC.Fset_mod_actions("forml_wz_2",{copy:{r:"forml_cc",v:"r"},get_usrcoll:{r:"collgrp_r",v:"r"},get_mon:{r:"filtermon_r",v:"r"},get_add:{r:"filteradd",v:"r"},search:{r:"forml_s",v:"r"},det:{r:"forml_r",v:"r"}}),MC.Fset_mod_actions("forml_assoc",{get:{r:"formls_avail_r",v:"r"},det:{r:"forml_r",v:"r"},assoc:{r:"bhdbr_u",v:"u"}}),MC.Fset_mod_actions("formulations",{add:{r:"forml_c",v:"r"},edit:{r:"forml_u",v:"r"},get:{r:"formls_r",v:"r"},det:{r:"forml_r",v:"r"}}),MC.Fset_mod_actions("compositions",{add:{r:"comp_c",v:"r"},edit:{r:"comp_u",v:"r"},get:{r:"comps_r",v:"r"},det:{r:"comp_r",v:"r"}}),MC.Fset_mod_actions("monomers",{add:{r:"mon_c",v:"r"},edit:{r:"mon_u",v:"r"},get:{r:"mons_r",v:"r"},det:{r:"mon_r",v:"r"}}),MC.Fset_mod_actions("comp_r",{get:{r:"bhdbr_er",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"}}),MC.Fset_mod_actions("comp_u",{get:{r:"bhdbr_r",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"comp_u",v:"r"}}),MC.Fset_mod_actions("comp_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"comp_c",v:"r"}}),MC.Fset_mod_actions("mon_r",{get:{r:"bhdbr_er",v:"r"},get_provs:{r:"bhdbdrvr_r",v:"r"},get_provider:{r:"monprov_r",v:"r"},img_zoom:{r:"FImgZoom",v:"r"}}),MC.Fset_mod_actions("mon_u",{get:{r:"bhdbr_r",v:"r"},get_provs:{r:"bhdbdrvr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"bhdbr_u",v:"r"},add_provider:{r:"monprov_c",v:"r"},edit_provider:{r:"monprov_u",v:"r"},get_provider:{r:"monprov_r",v:"r"},img_zoom:{r:"FImgZoom",v:"r"}}),MC.Fset_mod_actions("mon_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"bhdbr_c",v:"r"}}),MC.Fset_mod_actions("monprov_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"bhdbr_c",v:"r"}}),MC.Fset_mod_actions("monprov_r",{get:{r:"bhdbm2nr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"}}),MC.Fset_mod_actions("monprov_u",{get:{r:"bhdbm2nr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"bhdbm2nr_u",v:"r"}}),MC.Fset_mod_actions("xp_r",{get:{r:"bhdbr_r",v:"r"},get_fs:{r:"xps_f_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"xp_u",v:"r"},edit:{r:"forml_u",v:"r"},det:{r:"forml_r",v:"r"},add:{r:"forml_c",v:"r"},assoc:{r:"forml_assoc",v:"r"},copy:{r:"forml_wz_2",v:"r"},get_usrcoll:{r:"revgrp_r",v:"r"},tickets:{r:"bhdbr_r",v:"r"}}),MC.Fset_mod_actions("xp_u",{get:{r:"bhdbr_r",v:"r"},get_fs:{r:"xps_f_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"xp_u",v:"r"},edit:{r:"forml_u",v:"r"},det:{r:"forml_r",v:"r"},add:{r:"forml_c",v:"r"},addf:{r:"forml_c",v:"r"},assoc:{r:"forml_assoc",v:"r"},copy:{r:"forml_wz_2",v:"r"},get_usrcoll:{r:"revgrp_r",v:"r"},tickets:{r:"bhdbr_r",v:"r"},show_base:{r:"FShowBase",v:"r"},set_comp:{r:"bcomp_r",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},get_metrics:{r:"xp_metrics_r",v:"r"},get_kmetrics:{r:"xp_kmetrics_r",v:"r"},add_plan:{r:"planchart_c",v:"r"}}),MC.Fset_mod_actions("xp_c",{get:{r:"bhdbr_r",v:"r"},get_fs:{r:"xps_f_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"xp_c",v:"r"},edit:{r:"forml_u",v:"r"},det:{r:"forml_r",v:"r"},add:{r:"forml_c",v:"r"},assoc:{r:"forml_assoc",v:"r"},copy:{r:"forml_wz_2",v:"r"},get_usrcoll:{r:"revgrp_r",v:"r"}}),MC.Fset_mod_actions("forml_r",{get:{r:"bhdbr_er",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},out_get:{r:"fout_r",v:"r"},get_outs:{r:"fouts_r",v:"r"},det:{r:"forml_r",v:"r"},get_fs:{r:"xps_f_r",v:"r"},out_get:{r:"fout_r",v:"r"},get_usrcoll:{r:"collgrp_r",v:"r"}}),MC.Fset_mod_actions("forml_u",{get:{r:"bhdbr_r",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"forml_u",v:"r"},det:{r:"forml_r",v:"r"},get_fs:{r:"xps_f_r",v:"r"},set_comp:{r:"bcomp_r",v:"r"},get_outs:{r:"fouts_r",v:"r"},out_get:{r:"fout_r",v:"r"},out_new:{r:"fout_c",v:"r"},out_edit:{r:"fout_u",v:"r"},get_usrcoll:{r:"collgrp_r",v:"r"},amount_u:{r:"Famount_update",v:"r"}}),MC.Fset_mod_actions("forml_c",{catalog:{r:"bhdbcat_r",v:"r"},set_comp:{r:"bcomp_r",v:"r"},save:{r:"forml_c",v:"r"},get_usrcoll:{r:"collgrp_r",v:"r"},det:{r:"forml_r",v:"r"},get_fs:{r:"xps_f_r",v:"r"},amount_u:{r:"Famount_update",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},mon_image:{r:"FCanonicalImage",v:"r"},img_zoom:{r:"FImgZoom",v:"r"},update_percent:{r:"FSliderUpdatePercent",v:"r"},update_slider:{r:"FPercentUpdateSlider",v:"r"}}),MC.Fset_mod_actions("forml_cc",{get:{r:"bhdbr_r",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"forml_c",v:"r"},set_comp:{r:"bcomp_r",v:"r"},get_outs:{r:"fouts_r",v:"r"},out_get:{r:"fout_r",v:"r"},out_new:{r:"fout_c",v:"r"},out_edit:{r:"fout_u",v:"r"},get_usrcoll:{r:"collgrp_r",v:"r"},amount_u:{r:"Famount_update",v:"r"}}),MC.Fset_mod_actions("fout_u",{get:{r:"bhdbr_r",v:"r"},get_relrecs:{r:"fout_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"fout_u",v:"r"},add_att:{r:"fout_att_c",v:"r"},check_att:{r:"fout_att_u",v:"r"},show_clip:{r:"Fshow_clip",v:"r"},add_preset:{r:"outpreset_c",v:"r"},use_preset:{r:"outpreset_r",v:"r"}}),MC.Fset_mod_actions("fout_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"fout_c",v:"r"},add_att:{r:"fout_att_c",v:"r"},check_att:{r:"fout_att_u",v:"r"},add_preset:{r:"outpreset_c",v:"r"},use_preset:{r:"outpreset_r",v:"r"}}),MC.Fset_mod_actions("fout_r",{get:{r:"bhdbr_r",v:"r"},get_relrecs:{r:"fout_r",v:"r"},check_att:{r:"fout_att_r",v:"r"}}),MC.Fset_mod_actions("fout_att_c",{save:{r:"fout_att_c",v:"r"}}),MC.Fset_mod_actions("fout_att_u",{get:{r:"fout_att_r",v:"r"},add:{r:"fout_att_c",v:"r"},delete:{r:"fout_att_d",v:"r"},dlc:{r:"bhfsm_fe",v:"r"},adlc:{r:"bhfsm_rf",v:"r"}}),MC.Fset_mod_actions("fout_att_r",{get:{r:"fout_att_r",v:"r"},dlc:{r:"bhfsm_fe",v:"r"},adlc:{r:"bhfsm_rf",v:"r"}}),MC.Fset_mod_actions("outpreset_c",{save:{r:"outpreset_c",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"}}),MC.Fset_mod_actions("catalogs",{get:{r:"cats_r",v:"r"},det:{r:"cat_r",v:"r"}}),MC.Fset_mod_actions("cat_entry_u",{save:{r:"bhdbr_u",v:"r"},get:{r:"cate_r",v:"r"}}),MC.Fset_mod_actions("cat_r",{get:{r:"cat_r",v:"r"},edit:{r:"cat_entry_u",v:"r"},add:{r:"cat_entry_c",v:"r"}}),MC.Fset_mod_actions("test_impact",{process_a:{r:"FProcess_a",v:"r"},process_b:{r:"FProcess_b",v:"r"},reset_a:{r:"FReset_a",v:"r"},reset_b:{r:"FReset_b",v:"r"}}),MC.Fset_mod_actions("ai",{submit:{r:"ai_da",v:"r"},catalog:{r:"bhdbcat_r",v:"r"}}),MC.Fset_mod_actions("processes",{get:{r:"procs_r",v:"r"},add:{r:"proc_c",v:"r"},edit:{r:"proc_u",v:"r"},det:{r:"proc_r",v:"r"}}),MC.Fset_mod_actions("proc_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"proc_c",v:"r"},amount_u:{r:"Famount_update",v:"r"},set_type:{r:"FProcessSetType",v:"r"}}),MC.Fset_mod_actions("proc_u",{get:{r:"bhdbr_r",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},catalog:{r:"bhdbcat_r",v:"r"},save:{r:"proc_u",v:"r"},amount_u:{r:"Famount_update",v:"r"},set_type:{r:"FProcessSetType",v:"r"}}),MC.Fset_mod_actions("planner_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"plan_c",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},process_preview:{r:"proc_prev",v:"r"},amount_u:{r:"Famount_update",v:"x"},mat_selected:{r:"Planner.MaterialSelected",v:"x"},img_zoom:{r:"FImgZoom",v:"x"},update_percent:{r:"FSliderUpdatePercent",v:"x"},update_slider:{r:"FPercentUpdateSlider",v:"x"},set_process:{r:"Planner.ProcessPreview",v:"x"},process_select:{r:"proc_ctrl",v:"r"},process_next:{r:"Planner.ProcessNextSelect",v:"x"},mat_changed:{r:"Planner.MaterialList",v:"x"}}),MC.Fset_mod_actions("planchart_c",{catalog:{r:"bhdbcat_r",v:"r"},save:{r:"plan_c",v:"r"},get_relrecs:{r:"bhdbdrvr_r",v:"r"},process_preview:{r:"proc_prev",v:"r"},add_preset:{r:"outpreset_c",v:"r"},use_preset:{r:"outpreset_r",v:"r"},amount_u:{r:"Famount_update",v:"x"},mat_selected:{r:"Planner.MaterialSelected",v:"x"},img_zoom:{r:"FImgZoom",v:"x"},update_percent:{r:"FSliderUpdatePercent",v:"x"},update_slider:{r:"FPercentUpdateSlider",v:"x"},set_process:{r:"Planner.ProcessPreview",v:"x"},process_select:{r:"proc_ctrl",v:"r"},process_next:{r:"Planner.ProcessNextSelect",v:"x"},mat_changed:{r:"Planner.MaterialList",v:"x"}}),MC.Fonselect_br=function(t,e){var r=$(t+" #"+e).select2("data");MC.FMDE_action_values("C",{seldate:r.id}),MC.FreloadDE("C",$(t+" #"+e).attr("octarget"))},MC.FSWClick=function(t,e){var r=$(t+" #"+e).is(":checked")?"checked":"unchecked";console.log(r)},MC.FProcessSetType=function(t,e){let r=$(t+" #"+e),a=r.val();if(a){let t=r.closest("tr").find("input[name='min']"),e=r.closest("tr").find("input[name='max']"),o="#"+r.closest("tr").attr("id");switch(a){case"1":r.closest("tr").find(".v3, .v4").slideUp(_BH_FESets.slide_speed),r.closest("tr").find(".v1, .v2").slideDown(_BH_FESets.slide_speed),t.removeClass("mask_number masked").addClass("mask_decimal"),e.removeClass("mask_number masked").addClass("mask_decimal");break;case"2":r.closest("tr").find(".v3, .v4").slideUp(_BH_FESets.slide_speed),r.closest("tr").find(".v1, .v2").slideDown(_BH_FESets.slide_speed),t.removeClass("mask_decimal masked").addClass("mask_number"),e.removeClass("mask_decimal masked").addClass("mask_number");break;case"3":r.closest("tr").find(".v1, .v2, .v3").slideUp(_BH_FESets.slide_speed),r.closest("tr").find(".v4").slideDown(_BH_FESets.slide_speed);break;case"4":r.closest("tr").find(".v1, .v2, .v4").slideUp(_BH_FESets.slide_speed),r.closest("tr").find(".v3").slideDown(_BH_FESets.slide_speed)}WireUp.Finput_masks(o,"")}},MC.Planner={},MC.Planner.MaterialSelected=function(t,e){MC.FCanonicalImage(t,e),MC.Planner.MaterialList(t)},MC.Planner.MaterialList=function(t){$(".timeline-item.materials",t).each(function(){let t=[],e=[];$("select[name='monomer'].select2-hidden-accessible",$(this)).each(function(){t.push($(this).select2("data")[0].text)}),$("select[name='additive'].select2-hidden-accessible",$(this)).each(function(){e.push($(this).select2("data")[0].text)}),$("[data-source='"+this.id+"']").html("("+t.join("|")+") + ("+e.join("|")+")")})},MC.Planner.ProcessPreview=function(t,e){let r=$(t+" #"+e),a=$(t+" #"+r.attr("data-oc-target")),o=r.select2("data");o&&o[0]&&o[0].element&&o[0].element.dataset&&o[0].element.dataset.descr&&($(".card-content .card-title",a).html(o[0].text),$(".card-content .card-title + p",a).html(o[0].element.dataset.descr),$(".card-content",a).append("<p>"+o[0].element.dataset.p+"</p>")),$(t+" #"+e).closest("form").find("button").removeAttr("disabled")},MC.Planner.ProcessNextSelect=function(t,e){let r=$(t+" #"+e).attr("data-target");MC.Planner.PlanAddStep(t,r),"materials-select"==r&&MC.Planner.PlanAddStep(t,"process-select"),"processchar-select"==r&&$(".body .timeline .timeline-item.next-step-1",t).slideDown(_BH_FESets.slide_speed)},MC.Planner.PlanAddStep=function(t,e){let r=Viewer.FReadyContainer($(t+` .${e}`).clone(),random_nid()),a=$(".timeline-item",r).attr("id");$("[data-source]",r).attr("data-source",$(".timeline .timeline-item.materials:last",t).attr("id")),$(t+" .body .timeline .timeline-item:last-child").before(r.html()),Viewer.FWireUpContainer(t+` #${a}`),$(t+` #${a}`).slideDown(_BH_FESets.slide_speed),$(t+" .body .timeline .timeline-item:last-child").slideUp(_BH_FESets.slide_speed),MC.Planner.MaterialList(t)},MC.Planner.AddPanel=function(t,e,r){let a=Viewer.FReadyContainer($(t+` .${e}`).clone(),random_nid()),o=$(".panel",a).attr("id");$(".panel",a).attr("data-id",r),$("[data-source]",a).attr("data-source",$(".timeline .timeline-item.materials:last",t).attr("id")),$(t+" .detail-panel").append(a.html()),Viewer.FWireUpContainer(t+` #${o}`)},MC.Planner.SwitchToPanel=function(t,e){$(t+" .detail-panel .panel").slideUp(_BH_FESets.slide_speed),$(t+` .detail-panel [data-id='${e}']`).slideDown(_BH_FESets.slide_speed)},MC.Planner.SetUpControl=function(t,e={}){switch(e.type){case"1":case"2":$('[data-slider-type="int"]',t).attr("data-range-start",e.min).attr("data-range-end",e.max).attr("data-range-ini",e.min).attr("data-range-step",e.incr_step);break;case"3":e.item_list&&e.item_list.forEach(function(e){$("select",t).append(`<option value="${e}">${e}</option>`)})}return $("input",t).attr("name",e.label),$("select",t).attr("name",e.label),t},MC.Planner.UpdateNodeProperty=function(t,e,r,a){let o=$(t).orgDiagram("option","items");o.forEach((t,i)=>{t.id==e&&(o[i][r]=a)}),$(t).orgDiagram({items:o}),$(t).orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh)},MC.Fwz1_option=function(t,e){let r=$(t+" [name='new_type']:checked").val();$(t+" [name='wz_next']").attr("an",r)},MC.FShowBase=function(t,e){switch(parseInt($(t+" #"+e).val())){case 1:$(t+" [an='add_preset']").closest(".input-field").slideUp(_BH_FESets.slide_speed),$(t+" [id^='dye-composition-']").closest(".input-field").slideUp(_BH_FESets.slide_speed);break;case 2:$(t+" [id^='dye-composition-']").closest(".input-field").slideDown(_BH_FESets.slide_speed),$(t+" [an='add_preset']").closest(".input-field").slideUp(_BH_FESets.slide_speed);break;case 3:$(t+" [an='add_preset']").closest(".input-field").slideDown(_BH_FESets.slide_speed),$(t+" [id^='dye-composition-']").closest(".input-field").slideUp(_BH_FESets.slide_speed)}},MC.Fowner_only=function(t,e){let r=$(t+" #"+e).is(":checked"),a=parseInt($(t+" #"+e).attr("data-tcol")),o=$(t+" #"+e).attr(Viewer.oFEAttr.DataTarget),i=r?"qa":"";$(t+" #"+o+" table").DataTable().column(a).search(i).draw()},MC.Fshow_clip=function(t,e){$(t+" #"+e).closest("tr").find("[an='add_att']").show()},MC.FProcess_a=function(t,e){MsgToUsr.Falert_loading(null,"_processa__"),setTimeout(()=>{$("#ia").attr("src","fsm/tmp/size_of_objects_example_02.jpg"),MsgToUsr.Falert_loading("hide","_processa__")},6e3)},MC.FProcess_b=function(t,e){MsgToUsr.Falert_loading(null,"_processb__"),setTimeout(()=>{$("#ib").attr("src","fsm/tmp/20200630_164306.png"),MsgToUsr.Falert_loading("hide","_processb__")},4e3)},MC.FReset_a=function(t,e){$("#ia").attr("src","fsm/tmp/size_of_objects_example_01.jpg")},MC.FReset_b=function(t,e){$("#ib").attr("src","fsm/tmp/20200630_164306_.jpg")},MC.Famount_update=function(t,e){let r=$(t+" #"+e),a=$("[id*='form-data-']",t),o=parseFloat($("[name='amount']",a).val()),i=$("[id^='tbl-mons-cont-']",t),s=($("[id^='tbl-addit-cont-']",t),0);if(o=isNaN(o)?0:o,$("tbody tr input[name='percent']",i).each(function(t,e){let r=parseFloat($(this).val());r=isNaN(r)?0:r,s+=r,$(this).closest("tr").find("input[name='wt']").val((o*r/100).toFixed(4))}),s>100){if(r.hasClass("nuslider")){let t,a=document.getElementById(e).noUiSlider.get(),o=r.attr("data-range-step");o=o&&o.indexOf(".")>-1?parseFloat(o):parseInt(o),o=isNaN(o)?1:o,a=(a-=((t=Math.ceil(((s-100)/o).toFixed(2)))*o).toFixed(2)).toFixed(2),r.attr("data-dyn-max",a),s=100}}else $("[data-dyn-max]",i).removeAttr("data-dyn-max");$("tfoot [name='total-percent']",i).html(parseFloat(s.toFixed(2))),$("tfoot [name='total-amount']",i).html(parseFloat(o*s/100).toFixed(4))},MC.FImgZoom=function(t,e){let r=$(t+" #"+e),a=r.attr("id")+"-msg-"+random_nid();MsgToUsr.Falert_modal({id:random_nid(),title:"",content:r.clone().attr("id",a).outerHTML()})},MC.FUpdateTblSoftIns=function(t,e,r=1){$.each(e,function(e,a){$(".bh-drows-add",t).trigger("click"),a.def&&$.extend(a,a.def),$.each(a,function(e,a){if("idr"==e)$("tbody tr:last-of-type",t).attr("idr",a),$("tbody tr:last-of-type button",t).attr("idr",a);else{let o=$("tbody tr:nth-last-of-type("+r+") [name='"+e+"']",t);if(o.hasClass("chips")){let t=M.Chips.getInstance(o);a.forEach(e=>t.addChip({tag:e}))}else o.val(a),o.is("select")&&o.trigger("change")}})}),M.updateTextFields()},MC.FUpdateOutAttControl=function(t){$.each($("tr [name='out-att-scn']",t),function(){parseInt($(this).val())>0?($(this).closest("td").find("[an='check_att']").show(),$(this).closest("td").find("[an='add_att']").hide()):($(this).closest("td").find("[an='check_att']").hide(),$(this).closest("td").find("[an='add_att']").show())})},MC.FCanonicalImage=function(t,e){let r=$(t+" #"+e),a=r.closest("td").find(".molecule-svg"),o=r.select2("data");if(a){if(o&&o[0]&&o[0].element&&o[0].element.dataset&&o[0].element.dataset.canonical_smiles&&"null"!=o[0].element.dataset.canonical_smiles){let t;try{return t=OCL.Molecule.fromSmiles(o[0].element.dataset.canonical_smiles),a.html(t.toSVG(200,200,Math.random.toString(36),{suppressChiralText:!0,suppressCIPParity:!0})),void a.show()}catch(t){console.log(t)}}a.hide()}},MC.FSliderUpdatePercent=function(t,e){let r=$(t+" #"+e),a=r.attr("data-target"),o=document.getElementById(e),i=r.attr("data-slider-type");if(oT,a&&($(document.activeElement).hasClass("noUi-handle")||$(document.activeElement).is("body"))&&(oT=$(t+" #"+a).presence(),oT)){let t=parseFloat(o.noUiSlider.get()),e=parseInt(oT.val()),r=parseFloat(oT.val());switch(e=isNaN(e)?0:e,r=isNaN(r)?0:r,i){case"int":oT.val((r-e+t).toFixed(2));break;case"dec":oT.val((e+t).toFixed(2));break;case"float":oT.val(t)}}MC.Famount_update(t,e)},MC.FPercentUpdateSlider=function(t,e){let r,a=$(t+" #"+e),o=a.attr("data-target"),i=parseInt(a.val()),s=parseFloat(a.val());if(o){o.split(",").forEach((e,a)=>{if(r=$(t+" #"+e).presence()){let t=document.getElementById(e),a=r.attr("data-slider-type");switch(a=a||"int"){case"int":t.noUiSlider.set(i);break;case"dec":t.noUiSlider.set(s-i);break;case"float":t.noUiSlider.set(s)}}})}MC.Famount_update(t,e)},MC.Router.on("ajax_done","forml_c,forml_u,fout_c,fout_u,forml_cc,xp_u,xp_c",function(t,e){let r=MC.FMDE_get_p("C","ws_data"),a=$("[id^='tbl-mons-cont-']",t).presence(),o=$("[id^='tbl-addit-cont-']",t).presence(),i=$("[id*='form-data-']",t).presence();if((a=a||$("[id^='tbl-out-cont-']",t).presence())&&r[e].mxData&&r[e].mxData[1]&&r[e].mxData[1].ms){let o=t+" #"+a.attr("dyrows-cid"),i=$(o+" .bh-drows-add").html();$("tbody tr",a).remove(),$("tbody",a).append(i),MC.FUpdateTblSoftIns(a,r[e].mxData[1].ms)}if(o&&r[e].mxData&&r[e].mxData[1]&&r[e].mxData[1].as){let a=t+" #"+o.attr("dyrows-cid"),i=$(a+" .bh-drows-add").html();$("tbody tr",o).remove(),$("tbody",o).append(i),MC.FUpdateTblSoftIns(o,r[e].mxData[1].as)}return a&&o&&MC.Famount_update(t,e),i&&r[e].mxData&&r[e].mxData[1]&&$.each(r[e].mxData[1],function(t,e){$("[name='"+t+"']",i).presence()&&($("[name='"+t+"']",i).val(e).trigger("change"),$("[name='"+t+"'] + label",i).addClass("active"))}),{evgoon:!1}},"set_comp,use_preset"),MC.Router.on("ajax_done","planchart_c",function(t,e){let r=MC.FMDE_get_p("C","ws_data"),a=$(`#${e}`,t).attr("data-oc-target"),o=$(`#${a}`,t).presence(),i=$(`#${e}`,t).closest(".panel").attr("data-id");if(o&&r[e].mxData&&r[e].mxData[1]&&r[e].mxData[1].ms){let a=t+" #"+o.attr("dyrows-cid"),i=$(a+" .bh-drows-add").html();$("tbody tr",o).remove(),$("tbody",o).append(i),MC.FUpdateTblSoftIns(o,r[e].mxData[1].ms)}return MC.Planner.UpdateNodeProperty("#basicdiagram2",i,"name",$(t+" #"+e).select2("data")[0].text),{evgoon:!1}},"use_preset"),MC.Router.on("ajax_done","forml_u,fout_u,comp_u,forml_cc,xp_u,xp_c",function(t,e){return{evgoon:!1}},"get_relrecs"),MC.Router.on("ajax_done","fout_att_c",function(t,e){let r=MC.FMDE_get_p("C","ws_data");if(r[e].mxData&&r[e].mxData[1]&&r[e].mxData[1]._ffid){let t=[];t.push(r[e].mxData[1]._ffid),MC.FMDE_module_return({tot_att:1,new_att:t})}},"save"),MC.Router.on("ajax_done","planchart_c",function(t,e){let r=MC.FMDE_get_p("C","ws_data");if(r[e].mxData&&r[e].mxData[1]&&r[e].mxData[1].def){let a=$(`#${e}`,t).attr("data-target"),o=$(`#${e}`,t).closest("form").find(`#${a}`),i=r[e].mxData.slice(1),s=$("<tbody></tbody>"),n=$("<tr></tr>"),d=$(`#${e}`,t).closest(".panel").attr("data-id");n.append(`<td><span>Equipment / Tool</span></td><td>${i[0].tool}</td>`),s.append(n),i.forEach(t=>{let e=t.unit?` (${t.unit})`:"";(n=$("<tr></tr>")).append(`<td><span>${t.label}${e}</span></td><td>${html_entity_decode(t.control)}</td>`),s.append(Viewer.FReadyContainer(MC.Planner.SetUpControl(n,t.def),random_nid()))}),$(t+" #"+e).closest("form").find(".input-field").slideUp(_BH_FESets.slide_speed),$(t+" #"+e).slideUp(_BH_FESets.slide_speed),$(t+" #"+e).closest("form").find(".card-content .card-title ~ p").slideUp(_BH_FESets.slide_speed),o.append(s),Viewer.FWireUpContainer(`#${a}`),o.slideDown(_BH_FESets.slide_speed),$(".body .timeline .timeline-item.next-step-1",t).slideDown(_BH_FESets.slide_speed),$(".body .timeline .timeline-item.active",t).removeClass("active").find(".timeline-media").addClass("green lighten-3").find(".svg-icon").removeClass("svg-icon-primary").addClass("svg-icon-white solid"),MC.Planner.UpdateNodeProperty("#basicdiagram2",d,"name",$(t+" #"+e).closest("form").find(".card-content .card-title").text())}},"process_select"),MC.Module.on("data_reloaded","fout_att_r",function(t,e){let r=MC.FMDE_get_p("C","ws_data"),a=[];$.each(r[e].mxData,function(t,o){r[e].mxData[t]&&(0==t?MC.FMDE_module_return({tot_att:r[e].mxData[0]._nRec}):a.push(r[e].mxData[t].idr))}),MC.FMDE_module_return({new_att:a})},"get"),MC.Module.on("action","fout_att_r",function(t,e){let r=MC.FMDE_action_values();MC.FMDE_module_values("C",r)},"add"),MC.Module.on("action","fout_u",function(t,e){let r=$(t+" #"+e).closest("tr").attr("idr"),a=isNoE(r)?$(t+" #"+e).closest("tr").find("select").val():r,o=isNoE(r)?$(t+" #"+e).closest("td").find("[name='out-att-scn']").val():r;if(isNoE(a)){let t=Module.Fget_info_msg("error-select_fout_attr");return MsgToUsr.Fresult_msg(t.t+t.l,t.m),{evgoon:!1}}MC.FMDE_module_values("C",{fout_id:isNoE(r)?"":r,sub_id:a,att_scn:o})},"add_att,check_att"),MC.Module.on("action","forml_c,forml_u,forml_cc,xp_c,xp_u",function(t,e){let r={},a=bADupl=!1;if($(t+' tbody select[name="monomer"]').not("[data-b-bhautowire]").each(function(){if(r[$(this).val()])return a=!0,!1;r[$(this).val()]=1}),$(t+' tbody select[name="additive"]').not("[data-b-bhautowire]").each(function(){if(r[$(this).val()])return bADupl=!0,!1;r[$(this).val()]=1}),a||bADupl){if(a){let t=Module.Fget_info_msg("error-dupl_mon");MsgToUsr.Fresult_msg(t.t+t.l,t.m)}if(bADupl){let t=Module.Fget_info_msg("error-dupl_add");MsgToUsr.Fresult_msg(t.t+t.l,t.m)}return{evgoon:!1}}},"save"),MC.Module.on("action","fout_c",function(t,e){MC.FMDE_action_values("C",{fid:MC.FMDE_get_p("C","prnt_kv")})},"save"),MC.Module.on("action","monprov_c",function(t,e){MC.FMDE_action_values("C",{monomer:MC.FMDE_get_p("C","prnt_kv")})},"save"),MC.Module.on("action","xp_c,xp_u",function(t,e){MC.FMDE_action_values("C",{composition:$(t+" [id^='dye-composition-']").val()})},"set_comp"),MC.Module.on("action","planner_c",function(t,e){let r=MC.Ccur_mod,a=[],o=-1;$(`${t} .timeline-item:visible`).each(function(){return $(this).hasClass("materials")?(a[++o]={},a[o].mat=deparam(Gatherer.Fgather(r,"std",e,"#"+$(".bh-portlet",$(this)).attr("id"))),!0):$(this).hasClass("process-sel")?(a[o].proc=a[o].proc?a[o].proc:[],console.log($(".bh-portlet",$(this)).attr("id")),a[o].proc.push(deparam(Gatherer.Fgather(r,"std",e,"#"+$(".bh-portlet",$(this)).attr("id")))),!0):$(this).hasClass("processch-sel")?(a[o].pchar=a[o].pchar?a[o].pchar:[],console.log($(".bh-portlet",$(this)).attr("id")),a[o].pchar.push(deparam(Gatherer.Fgather(r,"std",e,"#"+$(".bh-portlet",$(this)).attr("id")))),!0):void 0}),console.log(a)},"save"),MC.Module.on("action_done","forml_wz_2",function(t,e){$(t+" [name='wz_next']").attr("disabled","disabled")},"search"),MC.Module.on("iaction_done","xp_u,xp_r",function(t,e){let r=MC.FMDE_get_p("L","ws_data");if(r[e].mxData&&r[e].mxData[1])for(oT of r[e].mxData)oT.t_id&&(console.log(oT),MC.jirat_update_sel($("#"+e),oT.t_id))},"tickets"),MC.Module.on("action","ai",function(t,e){MC.FMDE_action_values("C",{output:$(t+" #"+e).closest(".art-form").find("select").select2("data")[0].text})},"submit"),MC.Module.on("action_done","ai",function(t,e){let r=MC.FMDE_get_p("C","ws_data"),a={};r[e].mxData&&r[e].mxData[1]&&r[e].mxData[1].payload&&$.each(r[e].mxData[1].payload.__DescriptorData,function(t,e){$.each(e,function(e,r){isNoE(a[e])&&(a[e]={}),isNoE(a[e][t])&&(a[e][t]=[]),a[e][t]=r})});let o=1;$.each(a,function(t,e){MC.Fchart_descr("c"+o,t,e),o++})},"submit"),MC.Fchart_descr=function(t,e,r){var a=document.getElementById(t).getContext("2d");new Chart(a,{type:"bar",data:{labels:Object.keys(r),datasets:[{label:e,data:Object.values(r),backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})},MC.Module.on("show","forml_wz_2,forml_assoc",function(t,e){$(t+" .d_tbl").on("click","td",function(){$(t+" [name='wz_next']").removeAttr("disabled")})}),MC.Module.on("action","xp_u",function(t,e,r,a){return MC.Module.on("action_done","xp_u",function(t,e,r,a){console.log(MC.Module.off(a.e,a.m,a.a,a.lid)),MC.Faction("addf",$(t+" [an='add']").attr("id"))},"save"),$(t+" [an='save']").trigger("click"),{evgoon:!1}},"add"),MC.Module.on("action","forml_wz_2,forml_assoc",function(t,e){let r=$(t+" .d_tbl tr.tr-selected").attr("idr");if(isNoE(r)){let t=Module.Fget_info_msg("error-no_sel");return MsgToUsr.Fresult_msg(t.t+t.l,t.m),{evgoon:!1}}let a=MC.FMDE_action_values();a&&!isNoE(a.experiment)&&MC.FMDE_insert("L",{action_values:{experiment:a.experiment}}),$(t+" [name='wz_next']").attr("idr",r)},"copy,assoc"),MC.Module.on("action","xp_u",function(t,e){MC.FMDE_insert("L",{action_values:{experiment:MC.FMDE_get_p("C","cur_kv")}})},"add,copy,assoc"),MC.Module.on("show","forml_u,fout_u,comp_u,forml_c,forml_cc",function(t){$.each($("[data-bh-updatedef-event]",t),function(e){let r=MC.FMDE_get_p("C","ws_data"),a=this.id,o=$(t+" #"+a).attr("target"),i=$(t+" #"+o),s=t+" #"+i.attr("dyrows-cid");$(s+" .bh-drows-add").html();r[a].mxData&&r[a].mxData[1]&&MC.FUpdateTblSoftIns(i,r[a].mxData.slice(1)),MC.Famount_update(t,a),MC.FUpdateOutAttControl(i)})}),MC.Module.on("show","xp_u,proc_u,planner_c",function(t){$.each($("[data-bh-updatedef-event]",t),function(e){let r=MC.FMDE_get_p("C","ws_data"),a=this.id,o=$(t+" #"+a).attr("target"),i=$(t+" #"+o),s=t+" #"+i.attr("dyrows-cid"),n=$(s+" .bh-drows-add").hasClass("detached")?2:1;r[a].mxData&&r[a].mxData[1]&&MC.FUpdateTblSoftIns(i,r[a].mxData.slice(1),n)})}),MC.Module.on("display","xp_u",function(t){$(t+" [name='base_type']:checked").trigger("change")}),MC.Module.on("show","mon_u,mon_r",function(t){let e=$(".molecule-svg").presence(),r=$("form").attr("id");if(e){let t,a=MC.FMDE_get_p("C","ws_data");if(a&&a[r]&&a[r].mxData&&a[r].mxData[1]&&a[r].mxData[1].canonical_smiles)try{return t=OCL.Molecule.fromSmiles(a[r].mxData[1].canonical_smiles),void e.html(t.toSVG(200,200,Math.random.toString(36),{suppressChiralText:!0,suppressCIPParity:!0}))}catch(t){console.log(t)}e.hide()}}),MC.Module.on("show","fout_r",function(t){$.each($("table tr",t),function(t){"1"==$(this).attr("out-att-scn")&&$(".btn",$(this)).show()})}),MC.Module.on("show","planner_c",function(t){MC.Planner.PlanAddStep(t,"process-select")}),MC.Module.on("show","planchart_c",function(t){let e=1,r=new primitives.orgdiagram.Config,a=[new primitives.orgdiagram.ItemConfig({id:0,parent:null,type:"root",title:"material",templateName:"rootMaterial"}),new primitives.orgdiagram.ItemConfig({id:1,parent:0,title:"mprocess",type:"mprocess",templateName:"mProcess"})],o=function(t,e){let r={},a={};for(let e=0;e<t.length;e++){let a=t[e];null==r[a.parent]&&(r[a.parent]=[]),r[a.parent].push(a)}if(oNewChildren=r[e.id],null!=oNewChildren)for(;oNewChildren.length>0;){let t=[];for(let e=0;e<oNewChildren.length;e++){let o=oNewChildren[e];a[o.id]=o,null!=r[o.id]&&(t=t.concat(r[o.id]))}oNewChildren=t}return a},i=function(t,e,r){for(let a=0;a<t.length;a++){let o=t[a];if(o.parent==e&&o.type==r)return!0}return!1};MC.Planner.AddPanel(t,"process-select",e),r.items=a,r.cursorItem=0,r.hasSelectorCheckbox=primitives.common.Enabled.False,r.templates=[function(){let e=new primitives.orgdiagram.TemplateConfig;e.name="rootMaterial",e.itemSize=new primitives.common.Size(100,85),e.minimizedItemSize=new primitives.common.Size(3,3),e.cursorPadding=new primitives.common.Thickness(3,3,40,8);let r=$("<div></div>").css({position:"absolute",overflow:"hidden",width:e.itemSize.width+e.cursorPadding.left+e.cursorPadding.right+"px",height:e.itemSize.height+e.cursorPadding.top+e.cursorPadding.bottom+"px"}),a=$("<div></div>").css({width:e.itemSize.width+e.cursorPadding.left+1+"px",height:e.itemSize.height+e.cursorPadding.top+1+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame"),o=$("<div></div>").css({position:"absolute",top:e.cursorPadding.top+"px",left:e.itemSize.width+e.cursorPadding.left+10+"px",width:"30px",height:e.itemSize.height+1+"px"}).addClass("btn-group btn-group-vertical"),i=$($(".bprim-material",t).html()).addClass("bp-item bp-corner-all bt-item-frame");return r.append(a),o.append($(".root-material-btn",t).html()),r.append(o),e.cursorTemplate=r.outerHTML(),e.itemTemplate=i.outerHTML(),e}(),function(){let e=new primitives.orgdiagram.TemplateConfig;e.name="Material",e.itemSize=new primitives.common.Size(100,85),e.minimizedItemSize=new primitives.common.Size(3,3),e.cursorPadding=new primitives.common.Thickness(3,3,40,8);let r=$("<div></div>").css({position:"absolute",overflow:"hidden",width:e.itemSize.width+e.cursorPadding.left+e.cursorPadding.right+"px",height:e.itemSize.height+e.cursorPadding.top+e.cursorPadding.bottom+"px"}),a=$("<div></div>").css({width:e.itemSize.width+e.cursorPadding.left+1+"px",height:e.itemSize.height+e.cursorPadding.top+1+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame"),o=$("<div></div>").css({position:"absolute",top:e.cursorPadding.top+"px",left:e.itemSize.width+e.cursorPadding.left+10+"px",width:"30px",height:e.itemSize.height+1+"px"}).addClass("btn-group btn-group-vertical"),i=$($(".bprim-material",t).html()).addClass("bp-item bp-corner-all bt-item-frame");return r.append(a),o.append($(".material-btn",t).html()),r.append(o),e.cursorTemplate=r.outerHTML(),e.itemTemplate=i.outerHTML(),e}(),function(){let e=new primitives.orgdiagram.TemplateConfig;e.name="mProcess",e.itemSize=new primitives.common.Size(100,85),e.minimizedItemSize=new primitives.common.Size(3,3),e.cursorPadding=new primitives.common.Thickness(3,3,40,8);let r=$("<div></div>").css({position:"absolute",overflow:"hidden",width:e.itemSize.width+e.cursorPadding.left+e.cursorPadding.right+"px",height:e.itemSize.height+e.cursorPadding.top+e.cursorPadding.bottom+"px"}),a=$("<div></div>").css({width:e.itemSize.width+e.cursorPadding.left+1+"px",height:e.itemSize.height+e.cursorPadding.top+1+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame"),o=$("<div></div>").css({position:"absolute",top:e.cursorPadding.top+"px",left:e.itemSize.width+e.cursorPadding.left+10+"px",width:"30px",height:e.itemSize.height+1+"px"}).addClass("btn-group btn-group-vertical"),i=$($(".bprim-mprocess",t).html()).addClass("bp-item bp-corner-all bt-item-frame");return r.append(a),o.append($(".mprocess-btn",t).html()),r.append(o),e.cursorTemplate=r.outerHTML(),e.itemTemplate=i.outerHTML(),e}(),function(){let e=new primitives.orgdiagram.TemplateConfig;e.name="cProcess",e.itemSize=new primitives.common.Size(100,60),e.minimizedItemSize=new primitives.common.Size(3,3),e.cursorPadding=new primitives.common.Thickness(3,3,40,8);let r=$("<div></div>").css({position:"absolute",overflow:"hidden",width:e.itemSize.width+e.cursorPadding.left+e.cursorPadding.right+"px",height:e.itemSize.height+e.cursorPadding.top+e.cursorPadding.bottom+"px"}),a=$("<div></div>").css({width:e.itemSize.width+e.cursorPadding.left+1+"px",height:e.itemSize.height+e.cursorPadding.top+1+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame"),o=$("<div></div>").css({position:"absolute",top:e.cursorPadding.top+"px",left:e.itemSize.width+e.cursorPadding.left+10+"px",width:"30px",height:e.itemSize.height+1+"px"}).addClass("btn-group btn-group-vertical"),i=$($(".bprim-cprocess",t).html()).addClass("bp-item bp-corner-all bt-item-frame");return r.append(a),o.append($(".cprocess-btn",t).html()),r.append(o),e.cursorTemplate=r.outerHTML(),e.itemTemplate=i.outerHTML(),e}()],r.onItemRender=function(t,e){switch(e.renderingMode){case primitives.common.RenderingMode.Create:case primitives.common.RenderingMode.Update:}$("[name]",e.element).each(function(){$(this).text(e.context[$(this).attr("name")])})},r.hasButtons=primitives.common.Enabled.False,r.arrowsDirection=primitives.common.GroupByType.Children,r.onMouseClick=function(r,a){let s=$(r.originalEvent.target);if(s.hasClass("btn")||s.parent(".btn").length>0){let r,n=s.hasClass("btn")?s:s.parent(".btn"),d=n.attr("name"),c=$("#basicdiagram2").orgDiagram("option","items");switch(d){case"del":let s=[],n=o(c,a.context);n[a.context.id]=!0;for(let t=0;t<c.length;t++){let e=c[t];n.hasOwnProperty(e.id)||s.push(e)}$("#basicdiagram2").orgDiagram({items:s}),$("#basicdiagram2").orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh);break;case"add-material":r=new primitives.orgdiagram.ItemConfig({id:++e,parent:null,title:"material",type:"material",templateName:"Material"}),c.push(r),$("#basicdiagram2").orgDiagram({items:c,cursorItem:r.id}),$("#basicdiagram2").orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh);break;case"add-mprocess":i(c,a.context.id,"mprocess")||(r=new primitives.orgdiagram.ItemConfig({id:++e,parent:a.context.id,title:"mprocess",type:"mprocess",templateName:"mProcess"}),c.push(r),$("#basicdiagram2").orgDiagram({items:c,cursorItem:r.id}),$("#basicdiagram2").orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh),MC.Planner.AddPanel(t,"process-select",e));break;case"add-cprocess":r=new primitives.orgdiagram.ItemConfig({id:++e,parent:a.context.id,itemType:primitives.orgdiagram.ItemType.Adviser,title:"cprocess",type:"cprocess",templateName:"cProcess"}),c.push(r),$("#basicdiagram2").orgDiagram({items:c,cursorItem:r.id}),$("#basicdiagram2").orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh),MC.Planner.AddPanel(t,"cprocess-select",e)}}},r.onCursorChanged=function(e,r){MC.Planner.SwitchToPanel(t,r.context.id)},$("#basicdiagram2").orgDiagram(r)}),MC.Module.on("display","xp_c",function(t){$(t+" label").addClass("active")}),MC.Module.on("re-show","fout_u",function(t){let e=MC.FMDE_module_return(),r="#"+MC.FMDE_get_p("C","m_callb_tbid");if(null!=e){let a=$(t+" "+r).closest("tr").attr("idr");if(isNoE(a)){let a=isNoE(e.new_att)?[]:e.new_att,o=a.length>0?2:0;$(t+" "+r).closest("td").find("[name='out-natt']").val(a.join("|")),$(t+" "+r).closest("td").find("[name='out-att-scn']").val(o)}else{let a=isNoE(e.tot_att)?0:e.tot_att;a=a>0?1:0,$(t+" "+r).closest("td").find("[name='out-att-scn']").val(a)}}MC.FUpdateOutAttControl($(t+" "+r).closest("table"))}),MC.Module.on("iaction","cat_entry_u",function(){MC.FMDE_action_values("L",{ctbl:MC.FMDE_get_p("L","ctbl")})},"get"),MC.Module.on("action","cat_entry_u,cat_entry_c",function(t,e){MC.FMDE_action_values("C",{__srctbl:MC.FMDE_get_p("C","prnt_kv")})},"save"),MC.Module.on("loaded","track",function(t){$(t+" #seldate").val(Date.today().toString("yyyy-MM-dd")),MC.FMDE_action_values("C",{seldate:Date.today().toString("yyyy-MM-dd")})}),MC.Fstart_viewer(),MC.FMCache_state(!1)});